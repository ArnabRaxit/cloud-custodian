

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>c7n.actions package &mdash; Cloud Custodian  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/c1_labs.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/js/expand.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/expand.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="c7n.filters package" href="c7n.filters.html" />
    <link rel="prev" title="c7n package" href="c7n.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Cloud Custodian
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/usage.html">Monitoring your environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/advanced.html">Advanced Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/offhours.html">Example offhours policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/tagCompliance.html">Example tag compliance policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/index.html">Use Cases</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with AWS Lambda</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../policy/lambda.html">Lambda Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../policy/mu.html">Mu - Lambda Lifecycle Management</a></li>
</ul>
<p class="caption"><span class="caption-text">Policies reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../policy/index.html">Resource-Specific Filters and Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filters.html">Generic Filters</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contribute.html">Contributing to Cloud Custodian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/installing.html">Installing for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/tests.html">Testing for Developers</a></li>
</ul>
<p class="caption"><span class="caption-text">Azure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../azure/gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/authentication.html#azure-storage-access">Azure Storage access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/policy/index.html">Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/advanced/index.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/contribute.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/contribute.html#adding-new-azure-resources">Adding New Azure Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/contribute.html#testing">Testing</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">AWS</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="c7n.html">c7n package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="c7n.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">c7n.actions package</a></li>
<li class="toctree-l4"><a class="reference internal" href="c7n.filters.html">c7n.filters package</a></li>
<li class="toctree-l4"><a class="reference internal" href="c7n.reports.html">c7n.reports package</a></li>
<li class="toctree-l4"><a class="reference internal" href="c7n.resources.html">c7n.resources package</a></li>
<li class="toctree-l4"><a class="reference internal" href="c7n.ufuncs.html">c7n.ufuncs package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.cache">c7n.cache module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.cli">c7n.cli module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.commands">c7n.commands module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.config">c7n.config module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.credentials">c7n.credentials module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.ctx">c7n.ctx module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.cwe">c7n.cwe module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.exceptions">c7n.exceptions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.executor">c7n.executor module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.handler">c7n.handler module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.log">c7n.log module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.logs_support">c7n.logs_support module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.manager">c7n.manager module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.mu">c7n.mu module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.output">c7n.output module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.policy">c7n.policy module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.provider">c7n.provider module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.query">c7n.query module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.registry">c7n.registry module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.resolver">c7n.resolver module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.schema">c7n.schema module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.sqsexec">c7n.sqsexec module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.tags">c7n.tags module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.testing">c7n.testing module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.utils">c7n.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n.version">c7n.version module</a></li>
<li class="toctree-l3"><a class="reference internal" href="c7n.html#module-c7n">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../azure/modules.html">Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gcp/modules.html">GCP</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cloud Custodian</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">AWS</a> &raquo;</li>
        
          <li><a href="c7n.html">c7n package</a> &raquo;</li>
        
      <li>c7n.actions package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="c7n-actions-package">
<h1>c7n.actions package<a class="headerlink" href="#c7n-actions-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-c7n.actions.autotag">
<span id="c7n-actions-autotag-module"></span><h2>c7n.actions.autotag module<a class="headerlink" href="#module-c7n.actions.autotag" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="c7n.actions.autotag.AutoTagUser">
<em class="property">class </em><code class="descclassname">c7n.actions.autotag.</code><code class="descname">AutoTagUser</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em>, <em>log_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/autotag.html#AutoTagUser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.autotag.AutoTagUser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#c7n.actions.core.EventAction" title="c7n.actions.core.EventAction"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.actions.core.EventAction</span></code></a></p>
<p>Tag a resource with the user who created/modified it.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-auto-tag-ownercontact</span>
    <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">|</span>
      <span class="no">Triggered when a new EC2 Instance is launched. Checks to see if</span>
      <span class="no">it&#39;s missing the OwnerContact tag. If missing it gets created</span>
      <span class="no">with the value of the ID of whomever called the RunInstances API</span>
    <span class="l l-Scalar l-Scalar-Plain">mode</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">cloudtrail</span>
      <span class="l l-Scalar l-Scalar-Plain">role</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">arn:aws:iam::123456789000:role/custodian-auto-tagger</span>
      <span class="l l-Scalar l-Scalar-Plain">events</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">RunInstances</span>
    <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>
    <span class="l l-Scalar l-Scalar-Plain">actions</span><span class="p p-Indicator">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">auto-tag-user</span>
       <span class="l l-Scalar l-Scalar-Plain">tag</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">OwnerContact</span>
</pre></div>
</div>
<p>There’s a number of caveats to usage. Resources which don’t
include tagging as part of their api may have some delay before
automation kicks in to create a tag. Real world delay may be several
minutes, with worst case into hours[0]. This creates a race condition
between auto tagging and automation.</p>
<p>In practice this window is on the order of a fraction of a second, as
we fetch the resource and evaluate the presence of the tag before
attempting to tag it.</p>
<p>References</p>
<blockquote>
<div>CloudTrail User
<a class="reference external" href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-user-identity.html">https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-user-identity.html</a></div></blockquote>
<dl class="method">
<dt id="c7n.actions.autotag.AutoTagUser.get_permissions">
<code class="descname">get_permissions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/autotag.html#AutoTagUser.get_permissions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.autotag.AutoTagUser.get_permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.autotag.AutoTagUser.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>resources</em>, <em>event</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/autotag.html#AutoTagUser.process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.autotag.AutoTagUser.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.autotag.AutoTagUser.schema">
<code class="descname">schema</code><em class="property"> = {'additionalProperties': False, 'properties': {'principal_id_tag': {'type': 'string'}, 'tag': {'type': 'string'}, 'type': {'enum': ['auto-tag-user']}, 'update': {'type': 'boolean'}, 'user-type': {'items': {'enum': ['IAMUser', 'AssumedRole', 'FederatedUser'], 'type': 'string'}, 'type': 'array'}}, 'required': ['tag', 'type'], 'type': 'object'}</em><a class="headerlink" href="#c7n.actions.autotag.AutoTagUser.schema" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.autotag.AutoTagUser.schema_alias">
<code class="descname">schema_alias</code><em class="property"> = True</em><a class="headerlink" href="#c7n.actions.autotag.AutoTagUser.schema_alias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.autotag.AutoTagUser.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/autotag.html#AutoTagUser.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.autotag.AutoTagUser.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="c7n.actions.autotag.register_action_tag_user">
<code class="descclassname">c7n.actions.autotag.</code><code class="descname">register_action_tag_user</code><span class="sig-paren">(</span><em>registry</em>, <em>_</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/autotag.html#register_action_tag_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.autotag.register_action_tag_user" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-c7n.actions.core">
<span id="c7n-actions-core-module"></span><h2>c7n.actions.core module<a class="headerlink" href="#module-c7n.actions.core" title="Permalink to this headline">¶</a></h2>
<p>Actions to take on resources</p>
<dl class="class">
<dt id="c7n.actions.core.Action">
<em class="property">class </em><code class="descclassname">c7n.actions.core.</code><code class="descname">Action</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em>, <em>log_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/core.html#Action"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.core.Action" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="c7n.actions.core.Action.executor_factory">
<code class="descname">executor_factory</code><a class="headerlink" href="#c7n.actions.core.Action.executor_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">concurrent.futures.thread.ThreadPoolExecutor</span></code></p>
</dd></dl>

<dl class="method">
<dt id="c7n.actions.core.Action.get_permissions">
<code class="descname">get_permissions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/core.html#Action.get_permissions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.core.Action.get_permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.core.Action.log">
<code class="descname">log</code><em class="property"> = &lt;Logger custodian.actions (DEBUG)&gt;</em><a class="headerlink" href="#c7n.actions.core.Action.log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.core.Action.metrics">
<code class="descname">metrics</code><em class="property"> = ()</em><a class="headerlink" href="#c7n.actions.core.Action.metrics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.core.Action.name">
<code class="descname">name</code><a class="headerlink" href="#c7n.actions.core.Action.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.core.Action.permissions">
<code class="descname">permissions</code><em class="property"> = ()</em><a class="headerlink" href="#c7n.actions.core.Action.permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.core.Action.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>resources</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/core.html#Action.process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.core.Action.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.core.Action.schema">
<code class="descname">schema</code><em class="property"> = {'type': 'object'}</em><a class="headerlink" href="#c7n.actions.core.Action.schema" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.core.Action.schema_alias">
<code class="descname">schema_alias</code><em class="property"> = None</em><a class="headerlink" href="#c7n.actions.core.Action.schema_alias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.core.Action.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/core.html#Action.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.core.Action.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="c7n.actions.core.ActionRegistry">
<em class="property">class </em><code class="descclassname">c7n.actions.core.</code><code class="descname">ActionRegistry</code><span class="sig-paren">(</span><em>*args</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/core.html#ActionRegistry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.core.ActionRegistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="c7n.html#c7n.registry.PluginRegistry" title="c7n.registry.PluginRegistry"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.registry.PluginRegistry</span></code></a></p>
<dl class="method">
<dt id="c7n.actions.core.ActionRegistry.factory">
<code class="descname">factory</code><span class="sig-paren">(</span><em>data</em>, <em>manager</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/core.html#ActionRegistry.factory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.core.ActionRegistry.factory" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.core.ActionRegistry.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>data</em>, <em>manager</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/core.html#ActionRegistry.parse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.core.ActionRegistry.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="c7n.actions.core.BaseAction">
<code class="descclassname">c7n.actions.core.</code><code class="descname">BaseAction</code><a class="headerlink" href="#c7n.actions.core.BaseAction" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#c7n.actions.core.Action" title="c7n.actions.core.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.actions.core.Action</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="c7n.actions.core.EventAction">
<em class="property">class </em><code class="descclassname">c7n.actions.core.</code><code class="descname">EventAction</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em>, <em>log_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/core.html#EventAction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.core.EventAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#c7n.actions.core.Action" title="c7n.actions.core.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.actions.core.Action</span></code></a></p>
<p>Actions which receive lambda event if present</p>
</dd></dl>

</div>
<div class="section" id="module-c7n.actions.invoke">
<span id="c7n-actions-invoke-module"></span><h2>c7n.actions.invoke module<a class="headerlink" href="#module-c7n.actions.invoke" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="c7n.actions.invoke.LambdaInvoke">
<em class="property">class </em><code class="descclassname">c7n.actions.invoke.</code><code class="descname">LambdaInvoke</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em>, <em>log_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/invoke.html#LambdaInvoke"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.invoke.LambdaInvoke" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#c7n.actions.core.EventAction" title="c7n.actions.core.EventAction"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.actions.core.EventAction</span></code></a></p>
<p>Invoke an arbitrary lambda</p>
<p>serialized invocation parameters</p>
<blockquote>
<div><ul class="simple">
<li>resources / collection of resources</li>
<li>policy / policy that is invoke the lambda</li>
<li>action / action that is invoking the lambda</li>
<li>event / cloud trail event if any</li>
<li>version / version of custodian invoking the lambda</li>
</ul>
</div></blockquote>
<p>We automatically batch into sets of 250 for invocation,
We try to utilize async invocation by default, this imposes
some greater size limits of 128kb which means we batch
invoke.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">invoke</span><span class="o">-</span><span class="k">lambda</span>
  <span class="n">function</span><span class="p">:</span> <span class="n">my</span><span class="o">-</span><span class="n">function</span>
</pre></div>
</div>
<p>Note if your synchronously invoking the lambda, you may also need
to configure the timeout, to avoid multiple invokes. The default
is 90s, if the lambda doesn’t respond within that time the boto
sdk will invoke the lambda again with the same
arguments. Alternatively use async: true</p>
<dl class="attribute">
<dt id="c7n.actions.invoke.LambdaInvoke.permissions">
<code class="descname">permissions</code><em class="property"> = ('lambda:InvokeFunction',)</em><a class="headerlink" href="#c7n.actions.invoke.LambdaInvoke.permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.invoke.LambdaInvoke.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>resources</em>, <em>event=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/invoke.html#LambdaInvoke.process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.invoke.LambdaInvoke.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.invoke.LambdaInvoke.schema">
<code class="descname">schema</code><em class="property"> = {'properties': {'async': {'type': 'boolean'}, 'batch_size': {'type': 'integer'}, 'function': {'type': 'string'}, 'qualifier': {'type': 'string'}, 'timeout': {'type': 'integer'}, 'type': {'enum': ['invoke-lambda']}}, 'required': ['type', 'function'], 'type': 'object'}</em><a class="headerlink" href="#c7n.actions.invoke.LambdaInvoke.schema" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.invoke.LambdaInvoke.schema_alias">
<code class="descname">schema_alias</code><em class="property"> = True</em><a class="headerlink" href="#c7n.actions.invoke.LambdaInvoke.schema_alias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="c7n.actions.invoke.register_action_invoke_lambda">
<code class="descclassname">c7n.actions.invoke.</code><code class="descname">register_action_invoke_lambda</code><span class="sig-paren">(</span><em>registry</em>, <em>_</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/invoke.html#register_action_invoke_lambda"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.invoke.register_action_invoke_lambda" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-c7n.actions.metric">
<span id="c7n-actions-metric-module"></span><h2>c7n.actions.metric module<a class="headerlink" href="#module-c7n.actions.metric" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="c7n.actions.metric.PutMetric">
<em class="property">class </em><code class="descclassname">c7n.actions.metric.</code><code class="descname">PutMetric</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em>, <em>log_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/metric.html#PutMetric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.metric.PutMetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#c7n.actions.core.Action" title="c7n.actions.core.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.actions.core.Action</span></code></a></p>
<p>Action to put metrics based on an expression into CloudWatch metrics</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">track-attached-ebs</span>
    <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="l l-Scalar l-Scalar-Plain">comment</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">|</span>
      <span class="no">Put the count of the number of EBS attached disks to an instance</span>
    <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">tracked-ec2-instance</span>
    <span class="l l-Scalar l-Scalar-Plain">actions</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">put-metric</span>
        <span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Reservations[].Instances[].BlockDeviceMappings[].DeviceName</span>
        <span class="l l-Scalar l-Scalar-Plain">namespace</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Usage Metrics</span>
        <span class="l l-Scalar l-Scalar-Plain">metric_name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Attached Disks</span>
        <span class="l l-Scalar l-Scalar-Plain">op</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">count</span>
        <span class="l l-Scalar l-Scalar-Plain">units</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Files</span>
</pre></div>
</div>
<p>op and units are optional and will default to simple Counts.</p>
<dl class="attribute">
<dt id="c7n.actions.metric.PutMetric.permissions">
<code class="descname">permissions</code><em class="property"> = {'cloudwatch:PutMetricData'}</em><a class="headerlink" href="#c7n.actions.metric.PutMetric.permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.metric.PutMetric.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>resources</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/metric.html#PutMetric.process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.metric.PutMetric.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.metric.PutMetric.schema">
<code class="descname">schema</code><em class="property"> = {'properties': {'dimensions': {'items': {'type': 'object'}, 'type': 'array'}, 'key': {'type': 'string'}, 'metric_name': {'type': 'string'}, 'namespace': {'type': 'string'}, 'op': {'enum': ['count', 'distinct_count', 'sum', 'average']}, 'type': {'enum': ['put-metric']}, 'units': {'enum': ['Seconds', 'Microseconds', 'Milliseconds', 'Bytes', 'Kilobytes', 'Megabytes', 'Gigabytes', 'Terabytes', 'Bits', 'Kilobits', 'Megabits', 'Gigabits', 'Terabits', 'Bytes/Second', 'Kilobytes/Second', 'Megabytes/Second', 'Gigabytes/Second', 'Terabytes/Second', 'Bits/Second', 'Kilobits/Second', 'Megabits/Second', 'Gigabits/Second', 'Terabits/Second', 'Count/Second', 'Percent', 'Count', 'None']}}, 'required': ['type', 'key', 'namespace', 'metric_name'], 'type': 'object'}</em><a class="headerlink" href="#c7n.actions.metric.PutMetric.schema" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.metric.PutMetric.schema_alias">
<code class="descname">schema_alias</code><em class="property"> = True</em><a class="headerlink" href="#c7n.actions.metric.PutMetric.schema_alias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="c7n.actions.metric.average">
<code class="descclassname">c7n.actions.metric.</code><code class="descname">average</code><span class="sig-paren">(</span><em>numbers</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/metric.html#average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.metric.average" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="c7n.actions.metric.distinct_count">
<code class="descclassname">c7n.actions.metric.</code><code class="descname">distinct_count</code><span class="sig-paren">(</span><em>values</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/metric.html#distinct_count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.metric.distinct_count" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="c7n.actions.metric.register_action_put_metric">
<code class="descclassname">c7n.actions.metric.</code><code class="descname">register_action_put_metric</code><span class="sig-paren">(</span><em>registry</em>, <em>_</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/metric.html#register_action_put_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.metric.register_action_put_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-c7n.actions.network">
<span id="c7n-actions-network-module"></span><h2>c7n.actions.network module<a class="headerlink" href="#module-c7n.actions.network" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction">
<em class="property">class </em><code class="descclassname">c7n.actions.network.</code><code class="descname">ModifyVpcSecurityGroupsAction</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em>, <em>log_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/network.html#ModifyVpcSecurityGroupsAction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#c7n.actions.core.Action" title="c7n.actions.core.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.actions.core.Action</span></code></a></p>
<p>Common action for modifying security groups on a vpc attached resources.</p>
<p>Security groups for add or remove can be specified via group id or
name. Group removal also supports symbolic names such as
‘matched’, ‘network-location’ or ‘all’. ‘matched’ uses the
annotations/output of the ‘security-group’ filter
filter. ‘network-location’ uses the annotations of the
‘network-location’ interface filter for <cite>SecurityGroupMismatch</cite>.</p>
<p>Note a vpc attached resource requires at least one security group,
this action will use the sg specified in <cite>isolation-group</cite> to ensure
resources always have at least one security-group.</p>
<dl class="docutils">
<dt>type: modify-security-groups</dt>
<dd>add: []
remove: [] | matched | network-location
isolation-group: sg-xyz</dd>
</dl>
<dl class="attribute">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction.SYMBOLIC_SGS">
<code class="descname">SYMBOLIC_SGS</code><em class="property"> = {'all', 'matched', 'network-location'}</em><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction.SYMBOLIC_SGS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction.get_action_group_names">
<code class="descname">get_action_group_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/network.html#ModifyVpcSecurityGroupsAction.get_action_group_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction.get_action_group_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all the security group names configured in this action.</p>
</dd></dl>

<dl class="method">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction.get_group_names">
<code class="descname">get_group_names</code><span class="sig-paren">(</span><em>groups</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/network.html#ModifyVpcSecurityGroupsAction.get_group_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction.get_group_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction.get_groups">
<code class="descname">get_groups</code><span class="sig-paren">(</span><em>resources</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/network.html#ModifyVpcSecurityGroupsAction.get_groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction.get_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Return lists of security groups to set on each resource</p>
<p>For each input resource, parse the various add/remove/isolation-
group policies for ‘modify-security-groups’ to find the resulting
set of VPC security groups to attach to that resource.</p>
<p>Returns a list of lists containing the resulting VPC security groups
that should end up on each resource passed in.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>resources</strong> – List of resources containing VPC Security Groups</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of lists of security groups per resource</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction.get_groups_by_names">
<code class="descname">get_groups_by_names</code><span class="sig-paren">(</span><em>names</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/network.html#ModifyVpcSecurityGroupsAction.get_groups_by_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction.get_groups_by_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolve security names to security groups resources.</p>
</dd></dl>

<dl class="method">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction.resolve_group_names">
<code class="descname">resolve_group_names</code><span class="sig-paren">(</span><em>r</em>, <em>target_group_ids</em>, <em>groups</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/network.html#ModifyVpcSecurityGroupsAction.resolve_group_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction.resolve_group_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolve any security group names to the corresponding group ids</p>
<p>With the context of a given network attached resource.</p>
</dd></dl>

<dl class="method">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction.resolve_remove_symbols">
<code class="descname">resolve_remove_symbols</code><span class="sig-paren">(</span><em>r</em>, <em>target_group_ids</em>, <em>rgroups</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/network.html#ModifyVpcSecurityGroupsAction.resolve_remove_symbols"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction.resolve_remove_symbols" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolve the resources security groups that need be modified.</p>
<p>Specifically handles symbolic names that match annotations from policy filters
for groups being removed.</p>
</dd></dl>

<dl class="attribute">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction.schema">
<code class="descname">schema</code><em class="property"> = {'additionalProperties': False, 'anyOf': [{'required': ['isolation-group', 'remove', 'type']}, {'required': ['add', 'remove', 'type']}, {'required': ['add', 'type']}], 'properties': {'add': {'oneOf': [{'type': 'string'}, {'type': 'array', 'items': {'type': 'string'}}]}, 'isolation-group': {'oneOf': [{'type': 'string'}, {'type': 'array', 'items': {'type': 'string'}}]}, 'remove': {'oneOf': [{'type': 'array', 'items': {'type': 'string'}}, {'enum': ['matched', 'network-location', 'all', {'type': 'string'}]}]}, 'type': {'enum': ['modify-security-groups']}}, 'type': 'object'}</em><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction.schema" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction.schema_alias">
<code class="descname">schema_alias</code><em class="property"> = True</em><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction.schema_alias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction.sg_expr">
<code class="descname">sg_expr</code><em class="property"> = None</em><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction.sg_expr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/network.html#ModifyVpcSecurityGroupsAction.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.network.ModifyVpcSecurityGroupsAction.vpc_expr">
<code class="descname">vpc_expr</code><em class="property"> = None</em><a class="headerlink" href="#c7n.actions.network.ModifyVpcSecurityGroupsAction.vpc_expr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-c7n.actions.notify">
<span id="c7n-actions-notify-module"></span><h2>c7n.actions.notify module<a class="headerlink" href="#module-c7n.actions.notify" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="c7n.actions.notify.BaseNotify">
<em class="property">class </em><code class="descclassname">c7n.actions.notify.</code><code class="descname">BaseNotify</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em>, <em>log_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#BaseNotify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.BaseNotify" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#c7n.actions.core.EventAction" title="c7n.actions.core.EventAction"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.actions.core.EventAction</span></code></a></p>
<dl class="attribute">
<dt id="c7n.actions.notify.BaseNotify.batch_size">
<code class="descname">batch_size</code><em class="property"> = 250</em><a class="headerlink" href="#c7n.actions.notify.BaseNotify.batch_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.notify.BaseNotify.expand_variables">
<code class="descname">expand_variables</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#BaseNotify.expand_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.BaseNotify.expand_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>expand any variables in the action to_from/cc_from fields.</p>
</dd></dl>

<dl class="method">
<dt id="c7n.actions.notify.BaseNotify.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#BaseNotify.pack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.BaseNotify.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="c7n.actions.notify.Notify">
<em class="property">class </em><code class="descclassname">c7n.actions.notify.</code><code class="descname">Notify</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em>, <em>log_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#Notify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.Notify" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#c7n.actions.notify.BaseNotify" title="c7n.actions.notify.BaseNotify"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.actions.notify.BaseNotify</span></code></a></p>
<p>Flexible notifications require quite a bit of implementation support
on pluggable transports, templates, address resolution, variable
extraction, batch periods, etc.</p>
<p>For expedience and flexibility then, we instead send the data to
an sqs queue, for processing. ie. actual communications can be enabled
with the c7n-mailer tool, found under tools/c7n_mailer.</p>
<p>Attaching additional string message attributes are supported on the SNS
transport, with the exception of the <code class="docutils literal notranslate"><span class="pre">mtype</span></code> attribute, which is a
reserved attribute used by Cloud Custodian.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">policies</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">ec2</span><span class="o">-</span><span class="n">bad</span><span class="o">-</span><span class="n">instance</span><span class="o">-</span><span class="n">kill</span>
    <span class="n">resource</span><span class="p">:</span> <span class="n">ec2</span>
    <span class="n">filters</span><span class="p">:</span>
     <span class="o">-</span> <span class="n">Name</span><span class="p">:</span> <span class="n">bad</span><span class="o">-</span><span class="n">instance</span>
    <span class="n">actions</span><span class="p">:</span>
     <span class="o">-</span> <span class="n">terminate</span>
     <span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">notify</span>
       <span class="n">to</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">event</span><span class="o">-</span><span class="n">user</span>
        <span class="o">-</span> <span class="n">resource</span><span class="o">-</span><span class="n">creator</span>
        <span class="o">-</span> <span class="n">email</span><span class="nd">@address</span>
       <span class="n">owner_absent_contact</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">other_email</span><span class="nd">@address</span>
       <span class="c1"># which template for the email should we use</span>
       <span class="n">template</span><span class="p">:</span> <span class="n">policy</span><span class="o">-</span><span class="n">template</span>
       <span class="n">transport</span><span class="p">:</span>
         <span class="nb">type</span><span class="p">:</span> <span class="n">sqs</span>
         <span class="n">region</span><span class="p">:</span> <span class="n">us</span><span class="o">-</span><span class="n">east</span><span class="o">-</span><span class="mi">1</span>
         <span class="n">queue</span><span class="p">:</span> <span class="n">xyz</span>

  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">ec2</span><span class="o">-</span><span class="n">notify</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">attributes</span>
    <span class="n">resource</span><span class="p">:</span> <span class="n">ec2</span>
    <span class="n">filters</span><span class="p">:</span>
     <span class="o">-</span> <span class="n">Name</span><span class="p">:</span> <span class="n">bad</span><span class="o">-</span><span class="n">instance</span>
    <span class="n">actions</span><span class="p">:</span>
     <span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">notify</span>
       <span class="n">to</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">event</span><span class="o">-</span><span class="n">user</span>
        <span class="o">-</span> <span class="n">resource</span><span class="o">-</span><span class="n">creator</span>
        <span class="o">-</span> <span class="n">email</span><span class="nd">@address</span>
       <span class="n">owner_absent_contact</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">other_email</span><span class="nd">@address</span>
       <span class="c1"># which template for the email should we use</span>
       <span class="n">template</span><span class="p">:</span> <span class="n">policy</span><span class="o">-</span><span class="n">template</span>
       <span class="n">transport</span><span class="p">:</span>
         <span class="nb">type</span><span class="p">:</span> <span class="n">sns</span>
         <span class="n">region</span><span class="p">:</span> <span class="n">us</span><span class="o">-</span><span class="n">east</span><span class="o">-</span><span class="mi">1</span>
         <span class="n">topic</span><span class="p">:</span> <span class="n">your</span><span class="o">-</span><span class="n">notify</span><span class="o">-</span><span class="n">topic</span>
         <span class="n">attributes</span><span class="p">:</span>
           <span class="o">-</span> <span class="n">attribute_key</span><span class="p">:</span> <span class="n">attribute_value</span>
           <span class="o">-</span> <span class="n">attribute_key_2</span><span class="p">:</span> <span class="n">attribute_value_2</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="c7n.actions.notify.Notify.C7N_DATA_MESSAGE">
<code class="descname">C7N_DATA_MESSAGE</code><em class="property"> = 'maidmsg/1.0'</em><a class="headerlink" href="#c7n.actions.notify.Notify.C7N_DATA_MESSAGE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.notify.Notify.get_permissions">
<code class="descname">get_permissions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#Notify.get_permissions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.Notify.get_permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.notify.Notify.prepare_asg">
<code class="descname">prepare_asg</code><span class="sig-paren">(</span><em>resources</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#Notify.prepare_asg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.Notify.prepare_asg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.notify.Notify.prepare_ec2">
<code class="descname">prepare_ec2</code><span class="sig-paren">(</span><em>resources</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#Notify.prepare_ec2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.Notify.prepare_ec2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.notify.Notify.prepare_launch_config">
<code class="descname">prepare_launch_config</code><span class="sig-paren">(</span><em>resources</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#Notify.prepare_launch_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.Notify.prepare_launch_config" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.notify.Notify.prepare_resources">
<code class="descname">prepare_resources</code><span class="sig-paren">(</span><em>resources</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#Notify.prepare_resources"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.Notify.prepare_resources" title="Permalink to this definition">¶</a></dt>
<dd><p>Resources preparation for transport.</p>
<p>If we have sensitive or overly large resource metadata we want to
remove or additional serialization we need to perform, this
provides a mechanism.</p>
<p>TODO: consider alternative implementations, at min look at adding
provider as additional discriminator to resource type. One alternative
would be dynamically adjusting buffer size based on underlying
transport.</p>
</dd></dl>

<dl class="method">
<dt id="c7n.actions.notify.Notify.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>resources</em>, <em>event=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#Notify.process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.Notify.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.notify.Notify.schema">
<code class="descname">schema</code><em class="property"> = {'anyOf': [{'required': ['type', 'transport', 'to']}, {'required': ['type', 'transport', 'to_from']}], 'properties': {'assume_role': {'type': 'boolean'}, 'cc': {'items': {'type': 'string'}, 'type': 'array'}, 'cc_from': {'additionalProperties': 'False', 'properties': {'expr': {'oneOf': [{'type': 'integer'}, {'type': 'string'}]}, 'format': {'enum': ['csv', 'json', 'txt', 'csv2dict']}, 'url': {'type': 'string'}}, 'required': ['url'], 'type': 'object'}, 'cc_manager': {'type': 'boolean'}, 'from': {'type': 'string'}, 'owner_absent_contact': {'items': {'type': 'string'}, 'type': 'array'}, 'subject': {'type': 'string'}, 'template': {'type': 'string'}, 'to': {'items': {'type': 'string'}, 'type': 'array'}, 'to_from': {'additionalProperties': 'False', 'properties': {'expr': {'oneOf': [{'type': 'integer'}, {'type': 'string'}]}, 'format': {'enum': ['csv', 'json', 'txt', 'csv2dict']}, 'url': {'type': 'string'}}, 'required': ['url'], 'type': 'object'}, 'transport': {'oneOf': [{'type': 'object', 'required': ['type', 'queue'], 'properties': {'queue': {'type': 'string'}, 'type': {'enum': ['sqs']}}}, {'type': 'object', 'required': ['type', 'topic'], 'properties': {'topic': {'type': 'string'}, 'type': {'enum': ['sns']}, 'attributes': {'type': 'object'}}}]}, 'type': {'enum': ['notify']}}, 'type': 'object'}</em><a class="headerlink" href="#c7n.actions.notify.Notify.schema" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.notify.Notify.schema_alias">
<code class="descname">schema_alias</code><em class="property"> = True</em><a class="headerlink" href="#c7n.actions.notify.Notify.schema_alias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.notify.Notify.send_data_message">
<code class="descname">send_data_message</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#Notify.send_data_message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.Notify.send_data_message" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.notify.Notify.send_sns">
<code class="descname">send_sns</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#Notify.send_sns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.Notify.send_sns" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.notify.Notify.send_sqs">
<code class="descname">send_sqs</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#Notify.send_sqs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.Notify.send_sqs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.notify.Notify.type">
<code class="descname">type</code><em class="property"> = 'notify'</em><a class="headerlink" href="#c7n.actions.notify.Notify.type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.notify.Notify.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/notify.html#Notify.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.notify.Notify.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-c7n.actions.policy">
<span id="c7n-actions-policy-module"></span><h2>c7n.actions.policy module<a class="headerlink" href="#module-c7n.actions.policy" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="c7n.actions.policy.ModifyPolicyBase">
<em class="property">class </em><code class="descclassname">c7n.actions.policy.</code><code class="descname">ModifyPolicyBase</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/policy.html#ModifyPolicyBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.policy.ModifyPolicyBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#c7n.actions.core.Action" title="c7n.actions.core.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.actions.core.Action</span></code></a></p>
<dl class="method">
<dt id="c7n.actions.policy.ModifyPolicyBase.add_statements">
<code class="descname">add_statements</code><span class="sig-paren">(</span><em>policy_statements</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/policy.html#ModifyPolicyBase.add_statements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.policy.ModifyPolicyBase.add_statements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.policy.ModifyPolicyBase.remove_statements">
<code class="descname">remove_statements</code><span class="sig-paren">(</span><em>policy_statements</em>, <em>resource</em>, <em>matched_key</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/policy.html#ModifyPolicyBase.remove_statements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.policy.ModifyPolicyBase.remove_statements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.policy.ModifyPolicyBase.schema">
<code class="descname">schema</code><em class="property"> = {'additionalProperties': False, 'properties': {'add-statements': {'additionalProperties': False, 'items': {'$ref': '#/definitions/iam-statement'}, 'required': True, 'type': 'array'}, 'remove-statements': {'additionalProperties': False, 'oneOf': [{'enum': ['matched', '*']}, {'type': 'array', 'items': {'type': 'string'}}], 'required': True, 'type': ['array', 'string']}, 'type': {'enum': ['modify-policy']}}, 'required': ['type'], 'type': 'object'}</em><a class="headerlink" href="#c7n.actions.policy.ModifyPolicyBase.schema" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.policy.ModifyPolicyBase.schema_alias">
<code class="descname">schema_alias</code><em class="property"> = True</em><a class="headerlink" href="#c7n.actions.policy.ModifyPolicyBase.schema_alias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="c7n.actions.policy.RemovePolicyBase">
<em class="property">class </em><code class="descclassname">c7n.actions.policy.</code><code class="descname">RemovePolicyBase</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em>, <em>log_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/policy.html#RemovePolicyBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.policy.RemovePolicyBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#c7n.actions.core.Action" title="c7n.actions.core.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.actions.core.Action</span></code></a></p>
<dl class="method">
<dt id="c7n.actions.policy.RemovePolicyBase.process_policy">
<code class="descname">process_policy</code><span class="sig-paren">(</span><em>policy</em>, <em>resource</em>, <em>matched_key</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/policy.html#RemovePolicyBase.process_policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.policy.RemovePolicyBase.process_policy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.policy.RemovePolicyBase.schema">
<code class="descname">schema</code><em class="property"> = {'additionalProperties': False, 'properties': {'statement_ids': {'oneOf': [{'enum': ['matched']}, {'type': 'array', 'items': {'type': 'string'}}]}, 'type': {'enum': ['remove-statements']}}, 'required': ['statement_ids', 'type'], 'type': 'object'}</em><a class="headerlink" href="#c7n.actions.policy.RemovePolicyBase.schema" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="c7n.actions.policy.remove_statements">
<code class="descclassname">c7n.actions.policy.</code><code class="descname">remove_statements</code><span class="sig-paren">(</span><em>match_ids</em>, <em>statements</em>, <em>matched=()</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/policy.html#remove_statements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.policy.remove_statements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-c7n.actions.securityhub">
<span id="c7n-actions-securityhub-module"></span><h2>c7n.actions.securityhub module<a class="headerlink" href="#module-c7n.actions.securityhub" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="c7n.actions.securityhub.OtherResourcePostFinding">
<em class="property">class </em><code class="descclassname">c7n.actions.securityhub.</code><code class="descname">OtherResourcePostFinding</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em>, <em>log_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/securityhub.html#OtherResourcePostFinding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.securityhub.OtherResourcePostFinding" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#c7n.actions.securityhub.PostFinding" title="c7n.actions.securityhub.PostFinding"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.actions.securityhub.PostFinding</span></code></a></p>
<dl class="attribute">
<dt id="c7n.actions.securityhub.OtherResourcePostFinding.fields">
<code class="descname">fields</code><em class="property"> = ()</em><a class="headerlink" href="#c7n.actions.securityhub.OtherResourcePostFinding.fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.securityhub.OtherResourcePostFinding.format_resource">
<code class="descname">format_resource</code><span class="sig-paren">(</span><em>r</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/securityhub.html#OtherResourcePostFinding.format_resource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.securityhub.OtherResourcePostFinding.format_resource" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="c7n.actions.securityhub.OtherResourcePostFinding.register_resource">
<em class="property">classmethod </em><code class="descname">register_resource</code><span class="sig-paren">(</span><em>registry</em>, <em>event</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/securityhub.html#OtherResourcePostFinding.register_resource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.securityhub.OtherResourcePostFinding.register_resource" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="c7n.actions.securityhub.PostFinding">
<em class="property">class </em><code class="descclassname">c7n.actions.securityhub.</code><code class="descname">PostFinding</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em>, <em>log_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/securityhub.html#PostFinding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.securityhub.PostFinding" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#c7n.actions.core.Action" title="c7n.actions.core.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.actions.core.Action</span></code></a></p>
<p>Report a finding to AWS Security Hub.</p>
<p>Custodian acts as a finding provider, allowing users to craft
policies that report to the AWS SecurityHub.</p>
<p>For resources that are taggable, we will tag the resource with an identifier
such that further findings generate updates.</p>
<p>Example generate a finding for accounts that don’t have shield enabled.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>

 <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">account-shield-enabled</span>
   <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">account</span>
   <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">shield-enabled</span>
   <span class="l l-Scalar l-Scalar-Plain">actions</span><span class="p p-Indicator">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">post-finding</span>
       <span class="l l-Scalar l-Scalar-Plain">severity_normalized</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">6</span>
       <span class="l l-Scalar l-Scalar-Plain">types</span><span class="p p-Indicator">:</span>
         <span class="p p-Indicator">-</span> <span class="s">&quot;Software</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Configuration</span><span class="nv"> </span><span class="s">Checks/Industry</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">Regulatory</span><span class="nv"> </span><span class="s">Standards/NIST</span><span class="nv"> </span><span class="s">CSF</span><span class="nv"> </span><span class="s">Controls</span><span class="nv"> </span><span class="s">(USA)&quot;</span>
       <span class="l l-Scalar l-Scalar-Plain">recommendation</span><span class="p p-Indicator">:</span> <span class="s">&quot;Enable</span><span class="nv"> </span><span class="s">shield&quot;</span>
       <span class="l l-Scalar l-Scalar-Plain">recommendation_url</span><span class="p p-Indicator">:</span> <span class="s">&quot;https://www.example.com/policies/AntiDDoS.html&quot;</span>
       <span class="l l-Scalar l-Scalar-Plain">confidence</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
       <span class="l l-Scalar l-Scalar-Plain">compliance_status</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">FAILED</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="c7n.actions.securityhub.PostFinding.FindingVersion">
<code class="descname">FindingVersion</code><em class="property"> = '2018-10-08'</em><a class="headerlink" href="#c7n.actions.securityhub.PostFinding.FindingVersion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.securityhub.PostFinding.NEW_FINDING">
<code class="descname">NEW_FINDING</code><em class="property"> = 'New'</em><a class="headerlink" href="#c7n.actions.securityhub.PostFinding.NEW_FINDING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.securityhub.PostFinding.ProductName">
<code class="descname">ProductName</code><em class="property"> = 'default'</em><a class="headerlink" href="#c7n.actions.securityhub.PostFinding.ProductName" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.securityhub.PostFinding.format_resource">
<code class="descname">format_resource</code><span class="sig-paren">(</span><em>r</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/securityhub.html#PostFinding.format_resource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.securityhub.PostFinding.format_resource" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.securityhub.PostFinding.get_finding">
<code class="descname">get_finding</code><span class="sig-paren">(</span><em>resources</em>, <em>existing_finding_id</em>, <em>created_at</em>, <em>updated_at</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/securityhub.html#PostFinding.get_finding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.securityhub.PostFinding.get_finding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.securityhub.PostFinding.get_finding_tag">
<code class="descname">get_finding_tag</code><span class="sig-paren">(</span><em>resource</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/securityhub.html#PostFinding.get_finding_tag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.securityhub.PostFinding.get_finding_tag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.securityhub.PostFinding.group_resources">
<code class="descname">group_resources</code><span class="sig-paren">(</span><em>resources</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/securityhub.html#PostFinding.group_resources"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.securityhub.PostFinding.group_resources" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.securityhub.PostFinding.permissions">
<code class="descname">permissions</code><em class="property"> = ('securityhub:BatchImportFindings',)</em><a class="headerlink" href="#c7n.actions.securityhub.PostFinding.permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="c7n.actions.securityhub.PostFinding.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>resources</em>, <em>event=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/securityhub.html#PostFinding.process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.securityhub.PostFinding.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.securityhub.PostFinding.schema">
<code class="descname">schema</code><em class="property"> = {'additionalProperties': False, 'properties': {'batch_size': {'maximum': 10, 'minimum': 1, 'type': 'integer'}, 'compliance_status': {'enum': ['PASSED', 'WARNING', 'FAILED', 'NOT_AVAILABLE'], 'type': 'string'}, 'confidence': {'max': 100, 'min': 0, 'type': 'number'}, 'criticality': {'max': 100, 'min': 0, 'type': 'number'}, 'fields': {'type': 'object'}, 'recommendation': {'type': 'string'}, 'recommendation_url': {'type': 'string'}, 'region': {'description': 'cross-region aggregation target', 'type': 'string'}, 'severity': {'default': 0, 'type': 'number'}, 'severity_normalized': {'default': 0, 'max': 100, 'min': 0, 'type': 'number'}, 'type': {'enum': ['post-finding']}, 'types': {'items': {'enum': ['Software and Configuration Checks/Vulnerabilities', 'Software and Configuration Checks/Vulnerabilities/CVE', 'Software and Configuration Checks/AWS Security Best Practices', 'Software and Configuration Checks/AWS Security Best Practices/Network Reachability', 'Software and Configuration Checks/Industry and Regulatory Standards', 'Software and Configuration Checks/Industry and Regulatory Standards/CIS Host Hardening Benchmarks', 'Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark', 'Software and Configuration Checks/Industry and Regulatory Standards/PCI-DSS Controls', 'Software and Configuration Checks/Industry and Regulatory Standards/Cloud Security Alliance Controls', 'Software and Configuration Checks/Industry and Regulatory Standards/ISO 90001 Controls', 'Software and Configuration Checks/Industry and Regulatory Standards/ISO 27001 Controls', 'Software and Configuration Checks/Industry and Regulatory Standards/ISO 27017 Controls', 'Software and Configuration Checks/Industry and Regulatory Standards/ISO 27018 Controls', 'Software and Configuration Checks/Industry and Regulatory Standards/SOC 1', 'Software and Configuration Checks/Industry and Regulatory Standards/SOC 2', 'Software and Configuration Checks/Industry and Regulatory Standards/HIPAA Controls (USA)', 'Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls (USA)', 'Software and Configuration Checks/Industry and Regulatory Standards/NIST CSF Controls (USA)', 'Software and Configuration Checks/Industry and Regulatory Standards/IRAP Controls (Australia)', 'Software and Configuration Checks/Industry and Regulatory Standards/K-ISMS Controls (Korea)', 'Software and Configuration Checks/Industry and Regulatory Standards/MTCS Controls (Singapore)', 'Software and Configuration Checks/Industry and Regulatory Standards/FISC Controls (Japan)', 'Software and Configuration Checks/Industry and Regulatory Standards/My Number Act Controls (Japan)', 'Software and Configuration Checks/Industry and Regulatory Standards/ENS Controls (Spain)', 'Software and Configuration Checks/Industry and Regulatory Standards/Cyber Essentials Plus Controls (UK)', 'Software and Configuration Checks/Industry and Regulatory Standards/G-Cloud Controls (UK)', 'Software and Configuration Checks/Industry and Regulatory Standards/C5 Controls (Germany)', 'Software and Configuration Checks/Industry and Regulatory Standards/IT-Grundschutz Controls (Germany)', 'Software and Configuration Checks/Industry and Regulatory Standards/GDPR Controls (Europe)', 'Software and Configuration Checks/Industry and Regulatory Standards/TISAX Controls (Europe)', 'TTPs/Initial Access', 'TTPs/Execution', 'TTPs/Persistence', 'TTPs/Privilege Escalation', 'TTPs/Defense Evasion', 'TTPs/Credential Access', 'TTPs/Discovery', 'TTPs/Lateral Movement', 'TTPs/Collection', 'TTPs/Command and Control', 'Effects/Data Exposure', 'Effects/Data Exfiltration', 'Effects/Data Destruction', 'Effects/Denial of Service', 'Effects/Resource Consumption'], 'type': 'string'}, 'type': 'array'}}, 'required': ['types', 'type'], 'type': 'object'}</em><a class="headerlink" href="#c7n.actions.securityhub.PostFinding.schema" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="c7n.actions.securityhub.PostFinding.schema_alias">
<code class="descname">schema_alias</code><em class="property"> = True</em><a class="headerlink" href="#c7n.actions.securityhub.PostFinding.schema_alias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="c7n.actions.securityhub.build_vocabulary">
<code class="descclassname">c7n.actions.securityhub.</code><code class="descname">build_vocabulary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/c7n/actions/securityhub.html#build_vocabulary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#c7n.actions.securityhub.build_vocabulary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-c7n.actions">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-c7n.actions" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="c7n.filters.html" class="btn btn-neutral float-right" title="c7n.filters package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="c7n.html" class="btn btn-neutral float-left" title="c7n package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Capital One Services, LLC

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>